class ApplicationController < ActionController::Base
    protect_from_forgery
    before_action :user_activity
    before_action :block_ip_addresses

    private

    def user_activity
        current_user.try :touch
    end

    protected

    def block_ip_addresses
        blocked_ips = ["5.38.30.111", "24.114.53.244", "24.114.80.16", "24.114.85.115", "24.114.90.213", "24.114.90.249", "24.114.92.111", "24.114.92.247", "24.114.93.83", "24.114.94.246", "24.114.97.114", "24.114.97.236", "24.114.102.18", "24.114.102.147", "24.114.103.228", "24.114.107.40", "24.150.243.202", "24.156.201.13", "24.156.226.173", "24.156.232.230", "24.192.24.112", "24.192.177.22", "24.192.178.19", "24.192.185.233", "37.245.186.190", "39.36.77.110", "39.36.201.203", "45.58.112.134", "50.153.118.247", "50.153.119.130", "59.98.204.227", "61.0.141.100", "63.231.147.160", "65.51.47.130", "66.87.82.209", "66.87.114.41", "66.87.115.18", "66.87.122.87", "66.87.123.62", "66.87.123.134", "66.87.123.177", "67.253.225.131", "69.14.0.225", "69.14.180.179", "69.136.80.205", "70.50.104.132", "70.50.104.204", "70.50.104.245", "70.50.105.223", "70.50.105.247", "70.50.106.201", "70.50.106.216", "70.50.106.236", "70.50.107.25", "70.50.107.93", "70.50.107.152", "70.50.107.158", "70.50.108.60", "70.50.108.154", "70.50.108.197", "70.50.109.246", "70.50.110.117", "70.192.67.228", "70.192.68.99", "70.192.69.57", "70.195.138.117", "70.215.64.35", "70.215.64.55", "70.215.64.68", "70.215.64.222", "70.215.68.70", "70.215.70.99", "70.215.70.229", "70.215.73.107", "70.215.74.145", "70.215.79.11", "70.215.83.172", "70.215.84.47", "70.215.84.154", "70.215.84.179", "70.215.87.141", "70.215.93.114", "72.237.90.195", "73.112.12.39", "73.112.12.43", "73.112.12.143", "73.112.12.200", "73.112.13.46", "73.112.13.75", "73.112.13.80", "73.112.13.111", "73.112.13.115", "73.112.14.12", "73.112.14.109", "73.112.14.180", "73.112.15.1", "73.112.15.6", "73.112.15.21", "73.112.15.23", "73.112.15.27", "73.112.15.29", "73.112.15.75", "73.112.15.148", "73.112.15.165", "73.112.15.213", "73.112.15.222", "73.112.18.98", "73.197.73.88", "73.199.138.33", "73.199.236.35", "73.199.236.82", "73.215.156.62", "73.226.1.100", "73.242.101.60", "75.118.248.153", "76.125.147.98", "96.42.112.206", "96.230.99.46", "98.5.99.211", "99.8.18.159", "99.67.136.172", "99.67.137.1", "100.34.12.40", "100.35.204.110", "108.24.126.186", "138.123.74.133", "138.123.190.239", "142.167.78.71", "149.76.233.117", "149.76.233.143", "150.250.172.63", "162.17.245.169", "162.216.46.23", "162.216.46.108", "162.216.46.185", "172.56.20.38", "172.56.34.248", "172.56.35.136", "172.58.136.32", "172.58.136.197", "172.58.137.241", "172.58.140.16", "172.58.216.226", "172.58.224.193", "172.58.225.166", "172.98.85.36", "173.59.124.137", "173.70.170.164", "173.70.171.25", "173.70.171.100", "173.70.172.78", "173.70.173.15", "173.70.173.146", "173.70.173.156", "173.70.173.169", "173.70.175.238", "173.70.175.249", "173.70.178.226", "174.92.117.201", "174.95.48.38", "174.119.18.13", "182.186.197.238", "184.146.137.245", "184.151.37.10", "184.151.61.10", "184.151.246.201", "192.240.212.3", "198.199.134.15", "198.255.205.220", "204.124.136.17", "207.250.25.162", "209.95.50.27", "209.95.50.58", "209.95.50.67"]
        head :unauthorized if blocked_ips.include?(current_ip_address)
    end
  
    def current_ip_address
        request.env['HTTP_X_REAL_IP'] || request.env['REMOTE_ADDR']
    end
end
